#include <rp6502.h>
#include <stdint.h>
#include "constants.h"
#include "palette.h"

// 128-color Blue-Cyan-White gradient, mirrored to indices 128-255
static const uint16_t galaxy_palette_base[128] = {
    0x0000, 0x0003, 0x0004, 0x0005, 0x0006, 0x0007, 0x0008, 0x0009,
    0x000A, 0x000B, 0x000C, 0x000D, 0x000E, 0x000F, 0x0010, 0x0011,
    0x0012, 0x0013, 0x0014, 0x0015, 0x0016, 0x0017, 0x1018, 0x1819,
    0x201A, 0x281B, 0x301C, 0x381D, 0x401E, 0x481F, 0x501F, 0x581F,
    0x601F, 0x603F, 0x605F, 0x607F, 0x609F, 0x60BF, 0x60DF, 0x60FF,
    0x681F, 0x683F, 0x685F, 0x687F, 0x689F, 0x68BF, 0x68DF, 0x68FF,
    0x701F, 0x703F, 0x705F, 0x707F, 0x709F, 0x70BF, 0x70DF, 0x70FF,
    0x781F, 0x783F, 0x785F, 0x787F, 0x789F, 0x78BF, 0x78DF, 0x78FF,
    0x791F, 0x793F, 0x795F, 0x797F, 0x799F, 0x79BF, 0x79DF, 0x79FF,
    0x7A1F, 0x7A3F, 0x7A5F, 0x7A7F, 0x7A9F, 0x7ABF, 0x7ADF, 0x7AFF,
    0x83FF, 0x8BFF, 0x93FF, 0x9BFF, 0xA3FF, 0xABFF, 0xB3FF, 0xBBFF,
    0xC3FF, 0xCBFF, 0xD3FF, 0xDBFF, 0xE3FF, 0xEBFF, 0xF3FF, 0xFBFF,
    0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF,
    0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF,
    0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF,
    0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF, 0xFFFF
};

void palette_init(void)
{
    RIA.addr0 = PALETTE_ADDR;
    RIA.step0 = 1;
    for (uint16_t i = 0; i < 128; i++) {
        RIA.rw0 = galaxy_palette_base[i] & 0xFF;
        RIA.rw0 = galaxy_palette_base[i] >> 8;
    }
    for (uint16_t i = 0; i < 128; i++) {
        RIA.rw0 = galaxy_palette_base[i] & 0xFF;
        RIA.rw0 = galaxy_palette_base[i] >> 8;
    }
}
